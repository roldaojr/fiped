{% extends 'cbvadmin/semantic-ui/base_site.html' %}

{% block title %}Inscrever-se em oficinas{% endblock %}

{% block content %}
{% if form.non_field_errors %}
<div class="ui error message">
  {% for error in form.non_field_errors %}
  {{ error }}
  {% endfor %}
</div>
{% else %}
<div class="ui warning message">
  Você deve selecionar no máximo {{ global_preferences.oficinas__inscricao_max }} oficina(s)
</div>
{% endif %}
<form method="post" class="ui form">
  {% csrf_token %}
  <button type="submit" class="ui primary button">Salvar</button>
  <table class="ui table">
    <thead>
      <tr>
        <th></th>
        <th>Oficina</th>
        <th>Ministrante</th>
        <th>Vagas</th>
      </tr>
    </thead>
    <tbody>
    {% for choice in form.oficinas.field.queryset %}
      <tr>
        <td class="collapsing">
          {% spaceless %}
          {% if choice.pk in form.oficinas.value or choice.pk|slugify in form.oficinas.value %}
          <div class="ui fitted toggle checkbox">
            <input name="oficinas" id="id_oficinas_{{ choice.pk }}" value="{{ choice.pk }}" type="checkbox" checked="checked">
            <label></label>
          </div>
          {% else %}
          {% if choice.vagas_restantes > 0 %}
          <div class="ui fitted toggle checkbox">
            <input name="oficinas" id="id_oficinas_{{ choice.pk }}" value="{{ choice.pk }}" type="checkbox">
            <label></label>
          </div>
          {% endif %}
          {% endif %}
          {% endspaceless %}
        </td>
        <td>{{ choice.nome }}</td>
        <td>{{ choice.ministrante }}</td>
        <td {% if choice.vagas_restantes == 0%} class="negative"{% endif %}>{{ choice.vagas_restantes }}</td>
      </tr>
    {% empty %}
    <tr>
      <td colspan="3">Nenhuma oficina disponível</td>
    </tr>
    {% endfor %}
    </tbody>
  </table>
  <button type="submit" class="ui primary button">Salvar</button>
</form>
{% endblock %}
